<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <link rel="stylesheet" type="text/css" href="styles.css">
  </head>
  <body class="container">

    <header class="child">
      <form>
        
        <button>Next Tweet</button>

      </form>
    </header>

    <section id="tweets" class="child">
      <script>
        $(document).ready(function() {
          var $section = $('section');
          $section.html('');

          var index = streams.home.length - 1;
          while(index >= 0){
            var tweet = streams.home[index];
            var date = tweet.created_at;
            var timeStamp = '- ' + addZero(date.getHours()) + ':' + addZero(date.getMinutes()) + ':' + addZero(date.getSeconds());
            var $tweet = $('<div></div>');

            var user = tweet.user
            $tweet.addClass(user);

            $tweet.text('@' + tweet.user + ': ' + tweet.message + ' ' + timeStamp);
            $tweet.appendTo($section);
            index -= 1;
          }
          function showNewTweet() {
            index += 1;
            tweet = streams.home[index];
            date = tweet.created_at;
            timeStamp = '- ' + addZero(date.getHours()) + ':' + addZero(date.getMinutes()) + ':' + addZero(date.getSeconds());
            $tweet = $('<div></div>');

            user = tweet.user
            $tweet.addClass(user);
            $tweet.text('@' + tweet.user + ': ' + tweet.message + ' ' + timeStamp);
            $tweet.insertBefore($('div').first());  
          }
          function addZero(n) {
            return (n < 10 ? '0': '') + n;
          }
          $('button').on('click', showNewTweet);

          $('div').on('mouseenter', function() {
            var currentUser = $(this).attr('class');
            $('div').on('click', function() {
              $section = $('section');
              $section.html('');
              $('button').text('Back to Feed');

              var userIndex = streams.users[currentUser].length - 1;
              while(userIndex >= 0) {
                date = streams.users[currentUser][userIndex].created_at;
                timeStamp = '- ' + addZero(date.getHours()) + ':' + addZero(date.getMinutes()) + ':' + addZero(date.getSeconds());
                $tweet = $('<div></div>');
                $tweet.text('@' + currentUser + ': ' + streams.users[currentUser][userIndex].message + ' ' + timeStamp);
                $tweet.appendTo($section);

                userIndex -= 1;
              }
            });
          });

          $('div').on('mouseenter', function() {
            $(this).addClass('focus');
          });
          $('div').on('mouseleave', function() {
            $(this).removeClass('focus');
          });


        });
      </script>
    </section>

  </body>
</html>
